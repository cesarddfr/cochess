<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Juego Carriles Realista</title>

<style>
body{
  margin:0;
  overflow:hidden;
  background:#111;
  font-family:Arial, sans-serif;
}

#ui{
  position:absolute;
  top:10px;
  left:10px;
  color:white;
  z-index:10;
}

#road{
  position:absolute;
  width:420px;
  height:100vh;
  left:50%;
  transform:translateX(-50%);
  background:#555;
  overflow:hidden;
}

/* Carriles */
.lane{
  position:absolute;
  width:25%;
  height:100%;
  border-left:2px dashed #aaa;
}

.green{
  background:#0a3a1a;
  box-shadow:inset 0 0 30px #00ff66;
}

.ray{
  position:absolute;
  width:100%;
  height:80px;
  background:linear-gradient(transparent,rgba(0,255,120,.7),transparent);
  animation:rayMove .5s linear infinite;
}

@keyframes rayMove{
  from{top:-80px}
  to{top:100%}
}

/* Coche jugador */
#car{
  position:absolute;
  width:60px;
  height:110px;
  left:180px;
  bottom:80px;
}

/* SVG coche */
svg{
  width:100%;
  height:100%;
}

/* Batería */
#batteryBox{
  position:absolute;
  top:-38px;
  width:100%;
  text-align:center;
  font-size:10px;
  color:white;
}

#batteryBar{
  width:100%;
  height:6px;
  background:red;
}

#batteryFill{
  height:100%;
  width:100%;
  background:lime;
}

/* Coches de fondo */
.other-car{
  position:absolute;
  width:50px;
  height:100px;
  opacity:.9;
}
</style>
</head>

<body>

<div id="ui">
  <button onclick="changeCar()">Cambiar coche</button>
  <div id="speed">Velocidad: 0 km/h</div>
</div>

<div id="road">
  <div class="lane" style="left:0%"></div>
  <div class="lane" style="left:25%"></div>
  <div class="lane green" style="left:50%">
    <div class="ray"></div>
  </div>
  <div class="lane" style="left:75%"></div>

  <div id="car">
    <div id="batteryBox">
      BATERÍA
      <div id="batteryBar">
        <div id="batteryFill"></div>
      </div>
    </div>

    <!-- COCHE SVG REALISTA -->
    <svg viewBox="0 0 60 110">
      <path id="carBody" d="M10 5 Q30 -5 50 5 L55 25 L55 90 Q30 105 5 90 L5 25 Z" fill="#d40000"/>
      <rect x="18" y="18" width="24" height="20" rx="5" fill="#8fd3ff"/>
      <rect x="8" y="35" width="6" height="20" rx="3" fill="#000"/>
      <rect x="46" y="35" width="6" height="20" rx="3" fill="#000"/>
      <rect x="8" y="70" width="6" height="20" rx="3" fill="#000"/>
      <rect x="46" y="70" width="6" height="20" rx="3" fill="#000"/>
    </svg>
  </div>
</div>

<script>
const car=document.getElementById("car");
const carBody=document.getElementById("carBody");
const speedText=document.getElementById("speed");
const batteryFill=document.getElementById("batteryFill");
const road=document.getElementById("road");

let x=180;
let y=window.innerHeight-200;
let speed=0;
let battery=100;
let broken=false;

const cars=[
 {name:"Porsche",color:"#d40000"},
 {name:"Lambo",color:"#ffd000"},
 {name:"Mercedes",color:"#cfcfcf"},
 {name:"Tesla",color:"#00c8ff"}
];
let currentCar=0;

function changeCar(){
 currentCar=(currentCar+1)%cars.length;
 carBody.setAttribute("fill",cars[currentCar].color);
}

const keys={};
document.addEventListener("keydown",e=>keys[e.key.toLowerCase()]=true);
document.addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);

/* Coches fondo */
function spawnOtherCar(){
 const c=document.createElement("div");
 c.className="other-car";
 c.innerHTML=car.innerHTML;
 c.style.left=(Math.floor(Math.random()*4)*105+30)+"px";
 c.style.top="-120px";
 road.appendChild(c);
 let y=-120;

 function move(){
   y+=3;
   c.style.top=y+"px";
   if(y<window.innerHeight) requestAnimationFrame(move);
   else c.remove();
 }
 move();
}
setInterval(spawnOtherCar,1300);

/* Loop */
function loop(){
 if(!broken){
   if(keys.w){
     speed+=0.3;
     y-=2;
   }
   if(keys.s){
     speed-=0.4;
     y+=2;
   }
   if(keys.a) x-=3;
   if(keys.d) x+=3;
 }

 speed=Math.max(0,Math.min(speed,160));
 x=Math.max(0,Math.min(x,360));
 y=Math.max(50,Math.min(y,window.innerHeight-140));

 car.style.left=x+"px";
 car.style.top=y+"px";

 speedText.textContent="Velocidad: "+Math.floor(speed)+" km/h";

 battery-=0.05;
 if(x>210 && x<320) battery+=0.25;

 battery=Math.max(0,Math.min(100,battery));
 batteryFill.style.width=battery+"%";

 if(battery<=0){
   broken=true;
   speed=0;
   speedText.textContent="AVERÍA";
 }

 requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
